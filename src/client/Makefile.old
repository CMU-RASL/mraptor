#!gmake 	# Tell emacs about this file: -*- Makefile -*-  
# $Id: Makefile,v 1.17 2003/10/04 21:56:47 trey Exp $
#
# PROJECT:      microRAPTOR (for Grace and Atacama)
# DESCRIPTION:  This GUI requires GTK 1.2

######################################################################
# DO NOT MODIFY THIS HEADER SECTION

CHECKOUTDIR := $(shell pwd | perl -e '$$stem = ""; for (1..5) { $$dir = $$stem."src"; if (-d $$dir) { chop $$stem; print "$$stem"; exit 0; } $$stem = "../$$stem"; } print "*** COULD NOT FIND CHECKOUT DIR ***";')
MAKERULESDIR := ../Makerules
include $(MAKERULESDIR)/Makefile.head

##############################################################################
###                     BEGIN MODIFICATIONS BELOW!!!
###     Use   "make Makefile.template.full"   to obtain an annotated template
##############################################################################

# Comment out to use ClawText instead of ZVT terminal widget
USE_ZVT_TERM = 1

# special rules for building the parser

#CC	= /usr/bin/g++
SUBDIRS =
HEADERS = 
LIBSRCS = callbacks.c interface.c processWidget.c support.c clientIO.c ClawText.cc
LIBNAME = 
BINSRCS = claw.c
LOCALBINSRCS = 
SCRIPTS = 
MANPAGES =
WEBPAGES =
#CFLAGS += -D__cplusplus

# for gtk
CFLAGS += $(shell gtk-config --cflags)
LIBRARIES += $(shell gtk-config --libs)

ifdef USE_ZVT_TERM
CFLAGS += -DUSE_ZVT_TERM -I/usr/include/gnome-1.0
LIBRARIES += -lzvt -lgdk_imlib
endif

# for IPC / IPCHelper
CFLAGS += -I$(ATACAMA_MEMBERS_DIR)/software/external/include
LFLAGS += -L$(ATACAMA_MEMBERS_DIR)/software/external/lib/Linux-2.4
LIBRARIES += -lipc -lpthread -lrcl -lmrclient -lmrcommon -lutil -lXmu

ALL_SRC_FILES = $(LIBSRCS) $(BINSRCS) $(LOCALBINSRCS)
EXTRA_FILES_TO_CLEAN = *.tab.cc{,.h} *.yy.cc

BOTMP := $(LIBSRCS:%.c=$(ODIR)/%.o)
BINOBJFILES := $(BOTMP:%.cc=$(ODIR)/%.o)

###  Enter any binary-specific library dependencies like this:
# LIBRARIES_pre_$(BDIR)/____$(BSUF) = -lX11

include $(MAKERULESDIR)/Makefile.middle

##############################################################################
###  List all binary dependencies here
###  e.g., $(BDIR)/____$(BINSUF):  $(ODIR)/____.o $(LIB)

$(BDIR)/claw$(BINSUF): $(ODIR)/claw.o $(BINOBJFILES) $(LIB)

$(BDIR)/ipc_example$(BINSUF): $(ODIR)/ipc_example.o $(ODIR)/callbacks.o $(ODIR)/interface.o $(ODIR)/processWidget.o $(ODIR)/support.o $(ODIR)/clientIO.o $(LIB)

# ADD ANY SUBDIRS THAT NEED TO BE VISITED DURING A BUILD TO THE SUBDIRS LIST
SUBDIRS := 

######################################################################
# $Log: Makefile,v $
# Revision 1.17  2003/10/04 21:56:47  trey
# tweaked things to eliminate the need for the common/overlap directory and libmrcommonoverlap.a
#
# Revision 1.16  2003/08/19 17:49:17  brennan
# *** empty log message ***
#
# Revision 1.15  2003/08/08 19:19:58  trey
# made changes to enable compilation under g++ 3.2
#
# Revision 1.14  2003/08/08 15:20:22  brennan
# client: added ZVT terminal display option
# daemon: no net effect.
#
# Revision 1.13  2003/06/04 20:18:02  brennan
#  Note: Groups kind of work, but not perfectly.  They're in progress.
#
# Added preferences option to allow changing the number of back
#   history lines requested during a subscribe.
#
#   "pending" processes no longer have a stdin input buffer displayed
#
#   Fixed inconsistent subscribing/unsubscribing between group and
#   singleton viewing.
#
#   Fixed bug that caused any double-quote in a stdin input string to
#   truncate the string at that point.
#
#   Added checks to silently avoid all multiple redundant (un)subscribes.
#
# Revision 1.12  2003/03/28 17:38:15  trey
# rearranged locations of files so that the atacama project can use rcl without causing namespace conflicts
#
# Revision 1.11  2003/03/18 22:00:28  trey
# fixed performance issue with stdout updates by limiting the stdout buffer size
#
# Revision 1.10  2003/03/09 21:07:02  brennan
# Eliminated load config race condition; the client now only autoloads a
# config file to a daemon if the client connected after the daemon.
#
# Eliminated the off-by-one-line error in the \r implementation.
#
# Added idle time display to top of each processWidget and added an idle
#   column to the processTree.  An idle ping is fired every 30 seconds.
#   Idle time also updates on stdouts; it's falsely low, but what the hey...
#
# Status messages are now only printed if they effect a change in status.
#
# Swallow window option added (Ctrl+A  (swAllow)); allows swallowing of
#   arbitrary X windows into a tab of the display.  At the moment, doesn't
#   clean up after the now-subordinate window closes.
#
# Revision 1.9  2003/02/25 17:36:21  curmson
# made changes to compile on nunavut
#
# Revision 1.8  2003/02/18 07:40:56  brennan
# Almost completely switched over to using clientComm for output to daemon.
# Pretty much completely functional except for parsing of daemon's output.
# Lots of UI fixes & improvements.
#
# Revision 1.7  2003/02/17 21:25:19  brennan
# Switched from "microraptor" to "claw" as our executable.  I was getting
#   tired of typing "microraptor".  "claw" and "client" both start with a 'c';
#   that's my only rational for now (and that both dinos and birds have claws).
#   I might come up with an acronym in the future if I'm bored.
# Also implemented set'ing, added dialogs for setting process stuff & loading
#   local files, cleaned up a few UI issues.
#
# Revision 1.6  2003/02/17 19:48:49  trey
# added example of gtk/ipc event handling integration
#
# Revision 1.5  2003/02/17 00:24:59  brennan
# Changed Makefile to reflect my email to Trey. ;)
#
# Revision 1.4  2003/02/17 00:21:54  brennan
# Random fiddling.
#
# Revision 1.3  2003/02/16 18:34:43  brennan
# Moved microRaptor image into a header file to avoid segfaults if the image
# wasn't in the bin directory.
# Added hooks to run and kill processes via clientIO functions.
#
# Revision 1.2  2003/02/12 19:55:05  brennan
# Switched include and library flags to use gtk-config.
#
# Revision 1.1  2003/02/12 19:51:30  brennan
# Initial commit of microRaptor GUI.
#
# Revision 1.2  2003/02/05 22:50:21  trey
# remote runner now uses rcl, at least a bit
#
# Revision 1.1  2003/02/05 21:41:36  trey
# added makefile, a bit of cleanup
#
# Revision 1.1  2003/02/05 03:57:54  trey
# initial atacama check-in
#
#



